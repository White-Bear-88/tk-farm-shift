<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 200px 0 20px 0;">

<div style="font-size: 24px; margin-bottom: 12px;"><strong>Amazon Q</strong></div>
<div style="background: rgba(128, 128, 128, 0.15); border: 1px solid rgba(128, 128, 128, 0.25); border-radius: 8px; padding: 8px; margin: 4px 0; text-align: center;">
<div style="font-size: 14px; margin-bottom: 4px;"><strong>Did you know?</strong></div>
<div>You can now see logs with 1-Click!</div>
</div>

Select code & ask me to explain, debug or optimize it, or type `/` for quick actions

</div>

---

あなたは AWS サーバーレスアーキテクト兼フルスタックエンジニアとして行動してください。				
				
【プロジェクト概要】				
・酪農のシフト管理アプリを新規設計したい				
・UI/UX は完全に自由に提案して構いません（既存の HTML/JS は使用しない）				
・バックエンドは AWS サーバーレス（API Gateway + Lambda + DynamoDB）を前提とします				
・DynamoDB は単一テーブル設計を推奨します				
・インフラは CloudFormation（または SAM/CDK でも可）で IaC 化したい				
				
【依頼内容】				
1. 酪農の現場オペレーションに最適化された UI/UX を自由に提案してください。				
- 日付、従業員、作業種別（搾乳・給餌・清掃・見回りなど）				
- シフトの作成、割り当て、確認、変更				
- モバイル利用も想定した UI				
- DynamoDB のアクセスパターンに最適化された画面構造				
				
2. 上記 UI/UX を前提に、最適な DynamoDB 単一テーブル設計を提案してください。				
- PK/SK の設計				
- GSI の必要性				
- 想定されるアクセスパターン一覧				
- エンティティ（従業員、作業、シフト、日付など）のモデリング				
				
3. その DB モデルに基づく API 設計（REST）を提案してください。				
- CRUD 操作				
- シフト割り当てロジック				
- 従業員別のシフト取得				
- 日付別のシフト一覧取得				
- 作業種別フィルタリング				
				
4. API Gateway + Lambda + DynamoDB を構築する CloudFormation テンプレートを生成してください。				
- DynamoDB テーブル				
- API Gateway（REST）				
- Lambda 関数				
- IAM ロール				
- CORS 設定				
- デプロイ可能な完全なテンプレート				
				
5. Lambda のサンプル実装も生成してください。				
- CRUD 操作				
- DynamoDB SDK の使用例				
- シフト割り当てロジック				
				
6. 最後に、全体のアーキテクチャ図を文章で説明してください。

---

酪農シフト管理アプリの設計を提案いたします。現場の効率性を重視したUI/UXから、最適化されたDynamoDB設計、そして完全なサーバーレスアーキテクチャまで包括的に設計します。

## 1. UI/UX 提案

### メイン画面構成
- **ダッシュボード**: 今日のシフト概要、緊急通知
- **カレンダービュー**: 週間/月間シフト表示
- **シフト作成**: ドラッグ&ドロップでの直感的割り当て
- **従業員管理**: スキル・可用性管理
- **作業管理**: 作業種別・所要時間設定

### モバイル最適化
- タッチフレンドリーなボタンサイズ
- スワイプ操作でのシフト変更
- プッシュ通知対応
- オフライン対応（重要な情報のキャッシュ）

## 2. DynamoDB 単一テーブル設計

### テーブル構造
```
PK (Partition Key): エンティティタイプ#ID
SK (Sort Key): 関連情報#タイムスタンプ
```

### エンティティ設計
```
従業員: PK=EMP#{employee_id}, SK=PROFILE
シフト: PK=SHIFT#{date}, SK=EMP#{employee_id}#{task_type}
作業種別: PK=TASK#{task_id}, SK=CONFIG
日別サマリー: PK=DATE#{date}, SK=SUMMARY
```

### GSI設計
- **GSI1**: 従業員別シフト検索 (PK=employee_id, SK=date)
- **GSI2**: 作業種別別検索 (PK=task_type, SK=date#employee_id)

### アクセスパターン
1. 日付別全シフト取得
2. 従業員別シフト履歴
3. 作業種別別アサイン状況
4. 期間別シフト統計

## 3. API設計

### エンドポイント
```
GET /shifts/{date} - 日別シフト一覧
GET /employees/{id}/shifts - 従業員別シフト
POST /shifts - シフト作成
PUT /shifts/{id} - シフト更新
DELETE /shifts/{id} - シフト削除
GET /tasks - 作業種別一覧
POST /shifts/assign - 自動割り当て
```

## 4. CloudFormationテンプレート作成

---

酪農シフト管理アプリのCloudFormationテンプレートを作成します

---

## 5. Lambda実装サンプル

---

Lambdaソースコード用のディレクトリを作成します

---

shell

---

シフトCRUD操作のLambda関数を作成します

---

従業員別シフト取得のLambda関数を作成します

---

シフト自動割り当てのLambda関数を作成します

---

作業種別管理のLambda関数を作成します

---

デプロイ用のrequirements.txtファイルを作成します

---

初期データセットアップ用のスクリプトを作成します

---

デプロイ用のスクリプトを作成します

---

プロジェクトの説明とセットアップ手順を記載したREADMEファイルを作成します

---


## 6. 全体アーキテクチャ説明

### システム構成
酪農シフト管理システムは、完全サーバーレスアーキテクチャで構築されています。

**フロントエンド層**
- モバイルファーストのレスポンシブWebアプリ
- タッチ操作に最適化されたUI
- オフライン対応（重要データのローカルキャッシュ）

**API層 (API Gateway)**
- RESTful API エンドポイント
- CORS設定済み
- リクエスト/レスポンスの変換・検証
- スロットリング・認証機能

**ビジネスロジック層 (Lambda)**
- **shift_crud.py**: シフトCRUD操作
- **employee_shifts.py**: 従業員別シフト管理
- **shift_assignment.py**: 自動シフト割り当てロジック
- **task_management.py**: 作業種別管理

**データ層 (DynamoDB)**
- 単一テーブル設計による高パフォーマンス
- GSIによる効率的なクエリ
- オンデマンド課金でコスト最適化

### データフロー
1. **シフト作成**: フロントエンド → API Gateway → Lambda → DynamoDB
2. **シフト表示**: DynamoDB → Lambda → API Gateway → フロントエンド
3. **自動割り当て**: 複数テーブルスキャン → ビジネスロジック → 一括書き込み

### スケーラビリティ
- Lambda: 自動スケーリング（同時実行数1000まで）
- DynamoDB: オンデマンドで無制限スケール
- API Gateway: 秒間10,000リクエストまで対応

### 可用性・信頼性
- マルチAZ構成による高可用性
- DynamoDBの99.99%可用性SLA
- CloudWatch による監視・アラート

このアーキテクチャにより、酪農現場の24時間365日運用に対応し、従業員数やシフト数の増加にも柔軟に対応できるシステムを実現しています。